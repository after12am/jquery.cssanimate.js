/*
 * jquery.cssanimate.js
 *
 * A jQuery plugin provides a stylish and cute animation for your smartphone app.
 *
 * https://github.com/after12am/jquery.cssanimate.js
 *
 * Copyright 2012-2013 Satoshi Okami
 * Released under the MIT license
 */
(function(d){function f(a){return{format:function(b){if("object"==typeof b)return a.replace(/\{(\w+)\}/g,function(a,d){return b[d]});b=Array.prototype.slice.apply(arguments);return ss=b.reduce(function(a,d,e){return a.replace("{i}".replace("i",e),b[e])},a.toString())}}}d.fn.cssanimate=function(a,b,c,g,h){var a=a||{},f;"function"===typeof b&&(h=b,b=void 0);if(a.constructor===Array)return this.cache=this.cache||new e(d(this)),this.cssanimate.loopback.has_callback=!!h,this.cssanimate.loopback(this,a,
h);"function"===typeof c&&(h=c,c=void 0);"function"===typeof g&&(h=g,g=void 0);void 0!==a.duration&&(b=a.duration,delete a.duration);void 0!==a.delay&&(c=a.delay,delete a.delay);void 0!==a.ease&&(g=a.ease,delete a.ease);void 0!==a.property&&(f=a.property.constructor===Array?a.property.join(","):a.property,delete a.property);var i={duration:"number"===typeof b?b:400,delay:+c||0,ease:j[g]||g||"ease-in-out",style:"flat",property:f||"all"};return this.queue(function(){this.cache=this.cache||new e(d(this));
this.cache.compile(i,a).queue(h)})};d.fn._stop=d.fn.stop;d.fn.stop=function(a,b){this.cssanimate.loopback.has_callback&&(this.cssanimate.stop=!0);return d.fn._stop.apply(this,arguments)};d.fn.cssanimate.loopback=function(a,b,c){var g=[];b.forEach(function(a,b){g[b]=d.extend(!0,{},a)});g.forEach(function(b){a.cssanimate(b[0],b[1],b[2],b[3],b[4])});a.queue(function(){this.step=++this.step||1;"function"===typeof c&&d.proxy(c,a)(this.step);if(a.cssanimate.stop)return a.cssanimate.stop=!1,a.dequeue(),
a;this.cache=new e(d(this));a.cssanimate(b,c);a.dequeue()});return a};var j={"in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)","ease-in-quad":"cubic-bezier(0.550, 0.085, 0.680, 0.530)","ease-in-cubic":"cubic-bezier(0.550, 0.055, 0.675, 0.190)","ease-in-quart":"cubic-bezier(0.895, 0.030, 0.685, 0.220)","ease-in-quint":"cubic-bezier(0.755, 0.050, 0.855, 0.060)","ease-in-sine":"cubic-bezier(0.470, 0.000, 0.745, 0.715)",
"ease-in-expo":"cubic-bezier(0.950, 0.050, 0.795, 0.035)","ease-in-circ":"cubic-bezier(0.600, 0.040, 0.980, 0.335)","ease-in-back":"cubic-bezier(0.600, -0.280, 0.735, 0.045)","ease-out-quad":"cubic-bezier(0.250, 0.460, 0.450, 0.940)","ease-out-cubic":"cubic-bezier(0.215, 0.610, 0.355, 1.000)","ease-out-quart":"cubic-bezier(0.165, 0.840, 0.440, 1.000)","ease-out-quint":"cubic-bezier(0.230, 1.000, 0.320, 1.000)","ease-out-sine":"cubic-bezier(0.390, 0.575, 0.565, 1.000)","ease-out-expo":"cubic-bezier(0.190, 1.000, 0.220, 1.000)",
"ease-out-circ":"cubic-bezier(0.075, 0.820, 0.165, 1.000)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.320, 1.275)","ease-out-quad":"cubic-bezier(0.455, 0.030, 0.515, 0.955)","ease-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1.000)","ease-in-out-quart":"cubic-bezier(0.770, 0.000, 0.175, 1.000)","ease-in-out-quint":"cubic-bezier(0.860, 0.000, 0.070, 1.000)","ease-in-out-sine":"cubic-bezier(0.445, 0.050, 0.550, 0.950)","ease-in-out-expo":"cubic-bezier(1.000, 0.000, 0.000, 1.000)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.150, 0.860)",
"ease-in-out-back":"cubic-bezier(0.680, -0.550, 0.265, 1.550)"},e=function(a){this.elem=a;this.executable={};this.position=new i;this.rotation=new i;this.scale=new i(1,1,1);this.skew=new k};e.prefix=function(){var a=window.getComputedStyle(document.documentElement,""),a=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1];"WebKit|Moz|MS|O".match(RegExp("("+a+")","i"));return f("-{0}-").format(a)}();e.transitionEvent=function(){var a=d("<div>")[0],b={"-webkit-":"webkitTransitionEnd",
"-moz-":"transitionend","-ms-":"msTransitionEnd","-o-":"webkitTransitionEnd"},c;for(c in b)if(e.prefix===c)return b[c];return"transitionend"in a.style?"transitionend":null}();e.property=function(a){var b=d("<div>")[0],c=e.prefix,c=f("{0}{1}").format(c,a);return void 0!==b.style[c]?c:a};e.prototype.compile=function(a,b){_=d.extend(!0,{},b);this.parse(_);this.executable=d.extend(!0,{},this.build(a,_));return this};e.prototype.clear=function(){var a={};["transition-property","transition-timing-function",
"transition-duration","transform-style","transition-delay"].forEach(function(b){a[e.property(b)]=""});d(this).css(a)};e.prototype.queue=function(a){var b=this,c=e.property("transition-duration"),g=function(){this.is_animated=!0;for(var g=function(){d(this).unbind(e.transitionEvent,d.proxy(g,this));"function"===typeof a&&d.proxy(a,this)();this.is_animated=!1;d(this).dequeue();0===d(this).queue().length&&d.proxy(b.clear,this)()},f=0;!d(this).css(c)&&!(50<++f););if(b.executable[c].match(/^0/)){d(this).css(b.executable);
for(f=0;!d(this).css(c).match(/^0/)&&!(50<++f););"function"===typeof a&&d.proxy(a,this)();0===d(this).queue().length&&d.proxy(b.clear,this)();this.is_animated=!1;d(this).dequeue();return this}if(!e.transitionEvent)return d(this).css(b.executable),f=b.executable[c].match(/^([0-9]+)/),setTimeout(d.proxy(a,this),f[1]),this;d(this).bind(e.transitionEvent,d.proxy(g,this)).css(b.executable);return this};if(this.elem.is_animated)return setTimeout(d.proxy(g,this.elem)),this;d.proxy(g,this.elem)();return this};
e.prototype.parse=function(a){for(var b in a){a[b]=this.solveRelativeValue(b,a[b]);if("to"==b)this.parseTranslate(a[b]);else if("x"===b)this.position.x=+a[b];else if("y"===b)this.position.y=+a[b];else if("z"===b)this.position.z=+a[b];else if("rotate"===b)this.parseRotation(a[b]);else if("rotatex"===b)this.rotation.x=+a[b];else if("rotatey"===b)this.rotation.y=+a[b];else if("rotatez"===b)this.rotation.z=+a[b];else if("scale"===b)this.parseScale(a[b]);else if("scalex"===b)this.scale.x=+a[b];else if("scaley"===
b)this.scale.y=+a[b];else if("scalez"===b)this.scale.z=+a[b];else if("skew"===b)this.parseSkew(a[b]);else if("skewx"===b)this.skew.x=+a[b];else if("skewy"===b)this.skew.y=+a[b];else continue;delete a[b]}return this};e.prototype.matchRelativeValue=function(a){return a.match(/^\s*(\+=|-=)([0-9]+)\s*$/)};e.prototype.evaluate=function(a,b,c){switch(b){case "+=":return a+c;case "-=":return a-c}};e.prototype.solveRelativeValue=function(a,b){return b.constructor===String?this.solveRelativeValueStringInitializer(a,
b):b.constructor===Object?this.solveRelativeValueObjectInitializer(a,b):b.constructor===Array?this.solveRelativeValueArrayInitializer(a,b):b};e.prototype.solveRelativeValueStringInitializer=function(a,b){var c=this.matchRelativeValue(b);if(c)switch(a){case "to":return this.evaluate(this.position.x,c[1],+c[2]);case "x":return this.evaluate(this.position.x,c[1],+c[2]);case "y":return this.evaluate(this.position.y,c[1],+c[2]);case "z":return this.evaluate(this.position.z,c[1],+c[2]);case "rotate":return this.evaluate(this.rotation.z,
c[1],+c[2]);case "rotatex":return this.evaluate(this.rotation.x,c[1],+c[2]);case "rotatey":return this.evaluate(this.rotation.y,c[1],+c[2]);case "rotatez":return this.evaluate(this.rotation.z,c[1],+c[2]);case "scale":return[this.evaluate(this.scale.x,c[1],+c[2]),this.evaluate(this.scale.y,c[1],+c[2])];case "scalex":return this.evaluate(this.scale.x,c[1],+c[2]);case "scaley":return this.evaluate(this.scale.y,c[1],+c[2]);case "scalez":return this.evaluate(this.scale.z,c[1],+c[2]);case "skew":return[this.evaluate(this.skew.x,
c[1],+c[2]),this.evaluate(this.skew.y,c[1],+c[2])];case "skewx":return this.evaluate(this.skew.x,c[1],+c[2]);case "skewy":return this.evaluate(this.skew.y,c[1],+c[2])}return b};e.prototype.solveRelativeValueArrayInitializer=function(a,b){var c,d;switch(a){case "to":c=this.position;break;case "rotate":c=this.rotation;break;case "scale":c=this.scale;break;case "skew":c=this.skew}if(c){if(void 0!==b[0]&&b[0].constructor===String&&(d=this.matchRelativeValue(b[0])))b[0]=this.evaluate(c.x,d[1],+d[2]);if(void 0!==
b[1]&&b[1].constructor===String&&(d=this.matchRelativeValue(b[1])))b[1]=this.evaluate(c.y,d[1],+d[2]);if(void 0!==b[2]&&b[2].constructor===String&&(d=this.matchRelativeValue(b[2])))b[2]=this.evaluate(c.z,d[1],+d[2])}return b};e.prototype.solveRelativeValueObjectInitializer=function(a,b){return this.solveRelativeValueArrayInitializer(a,[b.x,b.y,b.z])};e.prototype.parseTranslate=function(a){if(a.constructor===Array){if(void 0!==a[0]&&(this.position.x=+a[0]),void 0!==a[1]&&(this.position.y=+a[1]),void 0!==
a[2])this.position.z=+a[2]}else if(a.constructor===Object){if(void 0!==a.x&&(this.position.x=+a.x),void 0!==a.y&&(this.position.y=+a.y),void 0!==a.z)this.position.z=+a.z}else this.position.x=+a};e.prototype.parseRotation=function(a){if(a.constructor===Array){if(void 0!==a[0]&&(this.rotation.x=+a[0]),void 0!==a[1]&&(this.rotation.y=+a[1]),void 0!==a[2])this.rotation.z=+a[2]}else if(a.constructor===Object){if(void 0!==a.x&&(this.rotation.x=+a.x),void 0!==a.y&&(this.rotation.y=+a.y),void 0!==a.z)this.rotation.z=
+a.z}else this.rotation.z=+a};e.prototype.parseScale=function(a){if(a.constructor===Array){if(void 0!==a[0]&&(this.scale.x=+a[0]),void 0!==a[1]&&(this.scale.y=+a[1]),void 0!==a[2])this.scale.z=+a[2]}else if(a.constructor===Object){if(void 0!==a.x&&(this.scale.x=+a.x),void 0!==a.y&&(this.scale.y=+a.y),void 0!==a.z)this.scale.z=+a.z}else this.scale.x=this.scale.y=+a};e.prototype.parseSkew=function(a){if(a.constructor===Array){if(void 0!==a[0]&&(this.skew.x=+a[0]),void 0!==a[1])this.skew.y=+a[1]}else if(a.constructor===
Object){if(void 0!==a.x&&(this.skew.x=+a.x),void 0!==a.y)this.skew.y=+a.y}else this.skew.x=this.skew.y=+a};e.prototype.build=function(a,b){var c={};c[e.property("transition-property")]=a.property;c[e.property("transition-duration")]=f("{0}ms").format(a.duration);c[e.property("transition-delay")]=f("{0}ms").format(a.delay);c[e.property("transition-timing-function")]=a.ease;c[e.property("transform-style")]=a.style;c[e.property("transform")]=[this.buildTranslate(),this.buildRotate(),this.buildScale(),
this.buildSkew()].join(" ");for(var d in b)c[e.property(d)]=b[d],c[d]=b[d];return c};e.prototype.buildTranslate=function(){return"-o-"===e.prefix?this.buildOTranslate():f("translate3d({0}px,{1}px,{2}px)").format(this.position.x,this.position.y,this.position.z)};e.prototype.buildOTranslate=function(){return f("translate({0}px,{1}px)").format(this.position.x,this.position.y)};e.prototype.buildRotate=function(){return"-o-"===e.prefix?this.buildORotate():f("rotateX({0}deg) rotateY({1}deg) rotateZ({2}deg)").format(this.rotation.x,
this.rotation.y,this.rotation.z)};e.prototype.buildORotate=function(){return f("rotate({0}deg)").format(this.rotation.z)};e.prototype.buildScale=function(){return f("scale({0},{1})").format(this.scale.x,this.scale.y)};e.prototype.buildSkew=function(){return f("skewX({0}deg) skewY({1}deg)").format(this.skew.x,this.skew.y)};var k=function(a,b){this.x=a||0;this.y=b||0},i=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};d.fn.to=function(a,b,c,d,e){return a.constructor!==Array?this:this.cssanimate({to:a},
b,c,d,e)};d.fn.rotate=function(a,b,c,d,e){return a.constructor!==Array?this:this.cssanimate({rotate:a},b,c,d,e)};d.fn.scale=function(a,b,c,d,e){return a.constructor!==Array?this:this.cssanimate({scale:a},b,c,d,e)};d.fn.skew=function(a,b,c,d,e){return a.constructor!==Array?this:this.cssanimate({skew:a},b,c,d,e)};d.fn.origin=function(a,b){d(this).queue(function(){d(this).css(e.property("transform-origin"),f("{0} {1}").format(a,b));for(var c=0;!d(this).css(e.property("transform-origin"))&&!(50<++c););
d(this).dequeue()});return this};d.fn.perspective=function(a){d(this).queue(function(){d(this).parent().css(e.property("perspective"),f("{0}px").format(+a||0));for(var b=0;!d(this).parent().css(e.property("perspective"))&&!(50<++b););d(this).dequeue()});return this}})(jQuery);
